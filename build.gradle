// TODO
// -CREATE PLATFORM SPECIFIC TASKS FOR INSTALLING LIBUV
apply plugin: 'c'
apply plugin: 'cpp'

task setup (type: Exec) {
    workingDir '.'
    if (System.properties['os.name'].toLowerCase().contains('windows')) {
        //run batch file
    }
    else {
        commandLine './setup.sh'
    }
}

model {
    buildTypes {
        debug
        release
    }

    repositories {
        libs (PrebuiltLibraries) {
            uv {
                headers.srcDir './uv/include'
                binaries.withType(StaticLibraryBinary) {
                    staticLibraryFile = file('./uv/.libs/libuv.a')
                }
            }
            jansson {
                headers.srcDir './jansson/build/include'
                binaries.withType(StaticLibraryBinary) {
                    staticLibraryFile = file('./jansson/build/lib/libjansson.a')
                }
            }
        }
    }
}

binaries.all {
    lib library: 'uv', linkage: 'static'
}

libraries {
    fleaux {}
    sdnb_editor {
        binaries.all {
            lib project: ':libsdbnc', library: 'sdnbc', linkage: 'static'
        }
    }
}

executables {
    test {
        binaries.all {
            lib libraries.fleaux.static
        }
    }
}

task runTests (type: Exec) {
    workingDir '.'
    commandLine './build/binaries/testExecutable/test'
}

task wrapper (type: Wrapper) {
    gradleVersion = '2.2'
}
